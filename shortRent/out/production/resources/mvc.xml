<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"

       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

       xmlns:context="http://www.springframework.org/schema/context"

       xmlns:util="http://www.springframework.org/schema/util" xmlns:mvc="http://www.springframework.org/schema/mvc"

       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd

		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.2.xsd



		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd">


    <context:annotation-config></context:annotation-config>


    <!-- 扫描本项目 -->

    <context:component-scan base-package="com.mlj.controller">

        <context:include-filter type="annotation"

                                expression="org.springframework.stereotype.Controller"/>

    </context:component-scan>


    <bean id="propertyConfigurer"

          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">

        <property name="locations">

            <list>

                <value>classpath:resources.properties</value>

            </list>

        </property>

        <property name="fileEncoding" value="utf-8"/>

    </bean>


    <!-- JSON -->

    <util:constant id="serializerFeature"

                   static-field="com.alibaba.fastjson.serializer.SerializerFeature.DisableCircularReferenceDetect"/>


    <bean id="fastJsonHttpMessageConverter"

          class="com.alibaba.fastjson.support.spring.FastJsonHttpMessageConverter">

        <property name="features" ref="serializerFeature"></property>

    </bean>


    <!-- 验证器 -->

    <bean id="validator"

          class="org.springframework.validation.beanvalidation.LocalValidatorFactoryBean">

        <property name="providerClass" value="org.hibernate.validator.HibernateValidator"></property>

        <property name="validationMessageSource" ref="messageSource"></property>

    </bean>


    <!--<bean id="messageSource"-->

    <!--class="org.springframework.context.support.ReloadableResourceBundleMessageSource">-->

    <!--<property name="basenames">-->

    <!--<list>-->

    <!--&lt;!&ndash; 在web环境中一定要定位到classpath 否则默认到当前web应用下找 &ndash;&gt;-->

    <!--<value>classpath:messages</value>-->

    <!--<value>classpath:org/hibernate/validator/ValidationMessages</value>-->

    <!--</list>-->

    <!--</property>-->

    <!--<property name="useCodeAsDefaultMessage" value="false"/>-->

    <!--<property name="defaultEncoding" value="UTF-8"/>-->

    <!--<property name="cacheSeconds" value="60"/>-->

    <!--</bean>-->


    <!-- 转换器 -->


    <!-- 上传 -->

    <!--<bean id="multipartResolver"-->

    <!--class="org.springframework.web.multipart.commons.CommonsMultipartResolver">-->

    <!--<property name="maxUploadSize" value="21474836480"/>-->

    <!--</bean>-->


    <!-- json 化异常 -->

    <bean id="annotationMethodHandlerExceptionResolver"

          class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerExceptionResolver">

        <property name="order" value="0"/>

    </bean>


    <bean class="org.springframework.web.servlet.view.ContentNegotiatingViewResolver">

        <property name="order" value="1"/>

        <property name="defaultViews">

            <list>

                <bean class="com.alibaba.fastjson.support.spring.FastJsonJsonView"/>

            </list>

        </property>

    </bean>


    <!--&lt;!&ndash; 认证拦截 &ndash;&gt;-->

    <!--<mvc:interceptors>-->

    <!--<bean class="com.ep.commons.tool.handle.MHandlerInterceptor"/>-->

    <!--</mvc:interceptors>-->


    <!--<mvc:annotation-driven validator="validator">-->

    <!--<mvc:message-converters>-->

    <!--<ref bean="fastJsonHttpMessageConverter"/>-->

    <!--</mvc:message-converters>-->

    <!--<mvc:async-support default-timeout="300000"/>-->

    <!--</mvc:annotation-driven>-->


    <!--<bean id="restExceptionResolver" class="com.ep.commons.tool.handle.RestExceptionHandler">-->

    <!--<property name="order" value="100"/>-->

    <!--<property name="messageConverters">-->

    <!--<list>-->

    <!--<ref bean="fastJsonHttpMessageConverter"/>-->

    <!--</list>-->

    <!--</property>-->

    <!--<property name="errorResolver">-->

    <!--<bean class="com.ep.commons.tool.handle.DefaultRestErrorResolver">-->

    <!--<property name="defaultMoreInfoUrl" value="mailto:wkwenka@gmail.com"/>-->

    <!--<property name="exceptionMappingDefinitions">-->

    <!--<map>-->

    <!--<entry key="com.moyuer.bsf.common.web.exception"-->

    <!--value="401, error.Unauthorized"/>-->

    <!--<entry key="org.springframework.orm.hibernate5.HibernateOptimisticLockingFailureException"-->

    <!--value="500, error.HibernateOptimisticLockingFailureException"/>-->

    <!--<entry key="org.springframework.dao.DataIntegrityViolationException"-->

    <!--value="500, error.ConstraintViolationException"/>-->


    <!--<entry key="Throwable" value="500"/>-->

    <!--</map>-->

    <!--</property>-->

    <!--</bean>-->

    <!--</property>-->

    <!--</bean>-->
    <!--配置视图解析器-->
    <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix" value="/jsp/"/>
        <property name="suffix" value=".jsp"/>
    </bean>

    <!--图片的上传-->
    <bean id="multipartResolver"
          class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
        <!-- 上传文件大小上限，单位为字节（10MB） -->
        <property name="maxUploadSize">
            <value>10485760</value>
        </property>
        <!-- 请求的编码格式，必须和jSP的pageEncoding属性一致，以便正确读取表单的内容，默认为ISO-8859-1 -->
        <property name="defaultEncoding">
            <value>UTF-8</value>
        </property>
    </bean>

    <!--<mvc:interceptors>-->
        <!--&lt;!&ndash; 用户登陆拦截器 &ndash;&gt;-->
        <!--<mvc:interceptor>-->
            <!--<mvc:mapping path="/**"/>-->

            <!--&lt;!&ndash; 需排除拦截的地址 &ndash;&gt;-->
            <!--<mvc:exclude-mapping path="/jsp/login.jsp"/>-->
            <!--<mvc:exclude-mapping path="/user/login"/>-->
            <!--<bean class="com.mlj.interceptor.LoginIntercepter"/>-->
        <!--</mvc:interceptor>-->
    <!--</mvc:interceptors>-->
</beans>

